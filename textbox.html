<!DOCTYPE html>
<html>
  <head>
    <title>Text Box Example</title>
    <style>
      p,
      label {
        font-family: Arial, Helvetica, sans-serif;
      }
    </style>
  </head>
  <body>
    <label for="myInput">Type something:</label>
    <input type="text" id="myInput" />
    <p>Text entered: <span id="displayText"></span></p>

    <script>
      const featureList = [
        {
          type: "Feature",
          geometry: {
            type: "Point",
            coordinates: [-0.15713, 51.522883],
          },
          properties: {
            name: "Baker Street",
          },
        },
        {
          type: "Feature",
          geometry: {
            type: "Point",
            coordinates: [-0.127277, 51.50741],
          },
          properties: {
            name: "Charing Cross",
          },
        },
      ];

      // Function to filter JSON blobs based on a matching name
      function filterJSONList(inputText) {
        // Initialize an empty array to store matching items
        const filteredList = [];

        // Iterate through the JSON list
        for (const item of featureList) {
          // Check if the name property matches the input text
          if (item.properties.name.toLowerCase() === inputText.toLowerCase()) {
            // Add the matching item to the filtered list
            filteredList.push(item);
          }
        }

        // Return the filtered list
        return filteredList;
      }

      // Get a reference to the input element and the display element
      const inputElement = document.getElementById("myInput");
      const displayElement = document.getElementById("displayText");

      // Initialize a variable to store the user's input
      let foundFeatures = [];

      // Add an input event listener to the input element
      inputElement.addEventListener("input", function () {
        existingValue = displayElement.textContent;

        const filteredItems = filterJSONList(inputElement.value);
        console.log("filteredItems", filteredItems);

        const isAlreadyInList = foundFeatures.some((item) => {
          // Perform a deep comparison of JSON objects
          stringifiedItem = JSON.stringify(item);
          stringifiedFilteredItem = JSON.stringify(filteredItems);
          console.log("stringifiedItem", stringifiedItem);
          console.log("stringifiedFilteredItem", stringifiedFilteredItem);
          return stringifiedItem === stringifiedFilteredItem;
        });

        // Update the displayElement to show the current input
        if (filteredItems.length > 0 && !isAlreadyInList) {
          for (const feature of filteredItems) {
            foundFeatures.push(feature);
            displayElement.textContent =
              existingValue.length == 0
                ? feature.properties.name
                : existingValue + ", " + feature.properties.name;
          }
        }

        console.log("foundFeatures", foundFeatures);
      });
    </script>
  </body>
</html>
